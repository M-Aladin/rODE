<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ordinary Differential Equation (ODE) Solvers Written in R Using S4 Classes â€¢ rODE</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">rODE</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="/index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/Comparison.html">Comparison of ODE solvers</a>
    </li>
    <li>
      <a href="articles/FallingParticle.html">Falling Particle ODE</a>
    </li>
    <li>
      <a href="articles/Kepler.html">Kepler. Interaction between two planets</a>
    </li>
    <li>
      <a href="articles/Pendulum.html">Pendulum with Euler-Richardson ODE solver</a>
    </li>
    <li>
      <a href="articles/Planet.html">Planet orbiting with Euler ODE solver</a>
    </li>
    <li>
      <a href="articles/Projectile.html">Projectile with RK4 solver</a>
    </li>
    <li>
      <a href="articles/Reaction.html">Chemical Reaction</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/f0nzie/rODE">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">
<!-- README.md is generated from README.Rmd.  -->

<div id="rode" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#rode" class="anchor"></a>rODE</h1></div>
<p>The goal of <code>rODE</code> is to explore R and its <code>S4</code> classes and its differences with Java and Python classes while exploring physics simulations by solving ordinary differential equations (<code>ODE</code>).</p>
<p>This is not your typical black-box ODE solver. You really have to develop your ODE algorithm using any of the ODE solvers available. The objective is learning while doing.</p>
<p><code>rODE</code> has been inspired on the extraordinary physics library for computer simulations <strong>OpenSourcePhyisics</strong>. Take a look at <a href="http://opensourcephysics.org" class="uri">http://opensourcephysics.org</a>.</p>
<p>The ODE solvers implemented in R so far:</p>
<ul>
<li>Euler</li>
<li>Euler-Richardson</li>
<li>RK4</li>
<li>RK45, Dormand-Prince45</li>
<li>Verlet</li>
</ul>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the latest version of <code>rODE</code> from github with:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools<span class="op">::</span><span class="kw"><a href="http://www.rdocumentation.org/packages/devtools/topics/install_github">install_github</a></span>(<span class="st">"f0nzie/rODE"</span>)</code></pre></div>
<p>Or from <code>CRAN</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"rODE"</span>)</code></pre></div>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<p>Example scripts are located under the folder <code>examples</code> inside the package.</p>
<p>These examples make use of a parent class containing a customized rate calculation as well as the step and startup method. The methods that you would commonly find in the base script or parent class are:</p>
<ul>
<li><code><a href="reference/getRate-method.html">getRate()</a></code></li>
<li><code><a href="reference/getState-method.html">getState()</a></code></li>
<li>
<code><a href="reference/step-method.html">step()</a></code> or <code><a href="reference/doStep-method.html">doStep()</a></code>
</li>
<li><code><a href="reference/setStepSize-method.html">setStepSize()</a></code></li>
<li>
<code><a href="reference/init-method.html">init()</a></code>, which is not the same as the <code>S4</code> class <code>initialize</code> method</li>
<li>
<code>initialize()</code>, and</li>
<li>the constructor</li>
</ul>
<p>These methods are defined in the virtual classes <code>ODE</code> and <code>ODESolver</code>.</p>
<p>Two other classes that serve as definition classes for the ODE solvers are: <code>AbstractODESolver</code> and <code>ODEAdaptiveSolver</code>.</p>
<p>For instance, the application <code>KeplerApp.R</code> needs the class <code>Kepler</code> located in the <code>Kepler.R</code> script, which is called with <code>planet &lt;- Kepler(r, v)</code>, an <code>ODE</code> object. The solver for the same application is <code>RK45</code> called with <code>solver &lt;- RK45(planet)</code>, where <code>planet</code> is a previuously declared <code>ODE</code> object. Since <code>RK45</code> is an ODE solver, the script <code>RK45.R</code> will be located in the folder <code>./R</code> in the package.</p>
</div>
<div id="vignettes" class="section level2">
<h2 class="hasAnchor">
<a href="#vignettes" class="anchor"></a>Vignettes</h2>
<p>The vignettes contain examples of the use of the various ODE solvers.</p>
<p>For instance, the notebook <code>Comparison</code> and <code>Kepler</code> use the ODE solver <code>RK45</code>; <code>FallingParticle</code> and <code>Planet</code> use the <code>Euler</code> solver; <code>Pendulum</code> makes use of <code>EulerRichardson</code>; <code>Planet</code> of <code>Euler</code>, <code>Projectile</code>; <code>Reaction</code> of <code>RK4</code>, and <code>KeplerEnergy</code> uses the ODE solver <code>Verlet</code>.</p>
</div>
</div>
<div id="tests" class="section level1">
<h1 class="hasAnchor">
<a href="#tests" class="anchor"></a>Tests</h1>
<p>There are tests for the core ODE solver classes under tests/testthat, as well as additional tests for the examples themselves.</p>
<div id="test-this-folder" class="section level3">
<h3 class="hasAnchor">
<a href="#test-this-folder" class="anchor"></a>Test this folder</h3>
<p>The tests for the examples are two: one for the base/parent classes such as <code>Kepler</code> or <code>Planet</code> or <code>Projectile</code>; this test runner is called <code>run_tests_this_folder.R</code>.</p>
<p>For the applications there is another runner (<code>run_test_applications.R</code>) that opens each of the applications as request for a return value. If the hard coded value is not returned, the test will fail. This ensures that any minor change in the core solver classes do not have any impact on the application solutions, and if there is, it must be explained.</p>
</div>
<div id="tests-all-the-application-examples" class="section level3">
<h3 class="hasAnchor">
<a href="#tests-all-the-application-examples" class="anchor"></a>Tests all the application examples</h3>
<p>You can test all applications under the <code>examples</code> folder by running the script <code>run_test_applications.R</code>. The way it works is by getting the list of all applications by filtering those ending with <code>App</code>. Then removes the extension <code>.R</code> from each app and starts looping to call each of the applications with <code>do.call</code>. A list contains the <code>expected</code> results that are compared against the result coming out from the call to the R application.</p>
</div>
</div>
<div id="applications" class="section level1">
<h1 class="hasAnchor">
<a href="#applications" class="anchor"></a>Applications</h1>
<ul>
<li>AdaptiveStepApp</li>
<li>ComparisonRK45App</li>
<li>FallingParticleODE</li>
<li>KeplerApp</li>
<li>KeplerEnergyApp</li>
<li>LogisticApp</li>
<li>PendulumApp</li>
<li>PlanetApp</li>
<li>ProjectileApp</li>
<li>ReactionApp</li>
<li>RigidBodyNXFApp</li>
<li>SHOApp</li>
<li>SpringRK4App</li>
<li>VanderpolApp</li>
<li>VanderpolMuTimeControlApp</li>
</ul>
<div id="adaptivestepapp" class="section level2">
<h2 class="hasAnchor">
<a href="#adaptivestepapp" class="anchor"></a>AdaptiveStepApp</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rODE)
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'rODE'</span>
<span class="co">#&gt; The following object is masked from 'package:stats':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     step</span>
<span class="kw"><a href="reference/importFromExamples.html">importFromExamples</a></span>(<span class="st">"AdaptiveStep.R"</span>)

<span class="co"># running function</span>
AdaptiveStepApp &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) {
    ode        &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">"Impulse"</span>)
    ode_solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/RK45-class.html">RK45</a></span>(ode)
    ode_solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/init-method.html">init</a></span>(ode_solver, <span class="fl">0.1</span>)
    ode_solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/setTolerance-method.html">setTolerance</a></span>(ode_solver, <span class="fl">1.0e-4</span>)
    i &lt;-<span class="st"> </span><span class="dv">1</span>; rowVector &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>)
    <span class="cf">while</span> (<span class="kw"><a href="reference/getState-method.html">getState</a></span>(ode)[<span class="dv">1</span>] <span class="op">&lt;</span><span class="st"> </span><span class="dv">12</span>) {
        rowVector[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">s1 =</span> <span class="kw"><a href="reference/getState-method.html">getState</a></span>(ode)[<span class="dv">1</span>],
                               <span class="dt">s2 =</span> <span class="kw"><a href="reference/getState-method.html">getState</a></span>(ode)[<span class="dv">2</span>],
                               <span class="dt">t  =</span> <span class="kw"><a href="reference/getState-method.html">getState</a></span>(ode)[<span class="dv">3</span>])
        ode_solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/step-method.html">step</a></span>(ode_solver)
        ode &lt;-<span class="st"> </span>ode_solver<span class="op">@</span>ode
        i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    }
    <span class="kw">return</span>(data.table<span class="op">::</span><span class="kw">rbindlist</span>(rowVector))
}

<span class="co"># run application</span>
solution &lt;-<span class="st"> </span><span class="kw">AdaptiveStepApp</span>()
<span class="kw">plot</span>(solution)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-3-1.png" width="672"></p>
</div>
<div id="comparisonrk45app" class="section level2">
<h2 class="hasAnchor">
<a href="#comparisonrk45app" class="anchor"></a>ComparisonRK45App</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ++++++++++++++++++++++++++++++++++++++++++++++++  example: ComparisonRK45App.R</span>
<span class="co"># Compares the solution by the RK45 ODE solver versus the analytical solution</span>
<span class="co"># Example file: ComparisonRK45App.R</span>
<span class="co"># ODE Solver:   Runge-Kutta 45</span>
<span class="co"># Class:        RK45</span>
<span class="kw">library</span>(rODE)
<span class="kw"><a href="reference/importFromExamples.html">importFromExamples</a></span>(<span class="st">"ODETest.R"</span>)

 ComparisonRK45App &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) {
     ode &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">"ODETest"</span>)                     <span class="co"># create an `ODETest` object</span>
     ode_solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/RK45-class.html">RK45</a></span>(ode)                   <span class="co"># select the ODE solver</span>
     ode_solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/setStepSize-method.html">setStepSize</a></span>(ode_solver, <span class="dv">1</span>)      <span class="co"># set the step</span>
     ode_solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/setTolerance-method.html">setTolerance</a></span>(ode_solver, <span class="fl">1e-8</span>)  <span class="co"># set the tolerance</span>
     time &lt;-<span class="st">  </span><span class="dv">0</span>
     rowVector &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>)
     i &lt;-<span class="st"> </span><span class="dv">1</span>
     <span class="cf">while</span> (time <span class="op">&lt;</span><span class="st"> </span><span class="dv">50</span>) {
         rowVector[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">t  =</span> ode_solver<span class="op">@</span>ode<span class="op">@</span>state[<span class="dv">2</span>],
                                <span class="dt">s1 =</span> <span class="kw"><a href="reference/getState-method.html">getState</a></span>(ode_solver<span class="op">@</span>ode)[<span class="dv">1</span>],
                                <span class="dt">s2 =</span> <span class="kw"><a href="reference/getState-method.html">getState</a></span>(ode_solver<span class="op">@</span>ode)[<span class="dv">2</span>],
                                <span class="dt">xs =</span> <span class="kw"><a href="reference/getExactSolution-method.html">getExactSolution</a></span>(ode_solver<span class="op">@</span>ode, time),
                                <span class="dt">rc =</span> <span class="kw"><a href="reference/getRateCounts-method.html">getRateCounts</a></span>(ode),
                                <span class="dt">time =</span> time)
         ode_solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/step-method.html">step</a></span>(ode_solver)       <span class="co"># advance one step</span>
         stepSize &lt;-<span class="st">  </span>ode_solver<span class="op">@</span>stepSize     <span class="co"># update the step size</span>
         time &lt;-<span class="st"> </span>time <span class="op">+</span><span class="st"> </span>stepSize
         state &lt;-<span class="st"> </span><span class="kw"><a href="reference/getState-method.html">getState</a></span>(ode_solver<span class="op">@</span>ode)    <span class="co"># get the `state` vector</span>
         i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
     }
     <span class="kw">return</span>(data.table<span class="op">::</span><span class="kw">rbindlist</span>(rowVector))    <span class="co"># a data table with the results</span>
 }
<span class="co"># show solution</span>
solution &lt;-<span class="st"> </span><span class="kw">ComparisonRK45App</span>()                          <span class="co"># run the example</span>
<span class="kw">plot</span>(solution)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-4-1.png" width="672"></p>
</div>
<div id="fallingparticleode" class="section level2">
<h2 class="hasAnchor">
<a href="#fallingparticleode" class="anchor"></a>FallingParticleODE</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># +++++++++++++++++++++++++++++++++++++++++++++++  example: FallingParticleApp.R</span>
<span class="co"># Application that simulates the free fall of a ball using Euler ODE solver</span>
<span class="kw">library</span>(rODE)
<span class="kw"><a href="reference/importFromExamples.html">importFromExamples</a></span>(<span class="st">"FallingParticleODE.R"</span>)      <span class="co"># source the class</span>

FallingParticleODEApp &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) {
    <span class="co"># initial values</span>
    initial_y &lt;-<span class="st"> </span><span class="dv">10</span>
    initial_v &lt;-<span class="st"> </span><span class="dv">0</span>
    dt &lt;-<span class="st"> </span><span class="fl">0.01</span>
    ball &lt;-<span class="st"> </span><span class="kw">FallingParticleODE</span>(initial_y, initial_v)
    solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/Euler-class.html">Euler</a></span>(ball)                        <span class="co"># set the ODE solver</span>
    solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/setStepSize-method.html">setStepSize</a></span>(solver, dt)            <span class="co"># set the step</span>
    rowVector &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>)
    i &lt;-<span class="st"> </span><span class="dv">1</span>
    <span class="co"># stop loop when the ball hits the ground, state[1] is the vertical position</span>
    <span class="cf">while</span> (ball<span class="op">@</span>state[<span class="dv">1</span>] <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) {
        rowVector[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">t  =</span> ball<span class="op">@</span>state[<span class="dv">3</span>],
                               <span class="dt">y  =</span> ball<span class="op">@</span>state[<span class="dv">1</span>],
                               <span class="dt">vy =</span> ball<span class="op">@</span>state[<span class="dv">2</span>])
        solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/step-method.html">step</a></span>(solver)                   <span class="co"># move one step at a time</span>
        ball &lt;-<span class="st"> </span>solver<span class="op">@</span>ode                       <span class="co"># update the ball state</span>
        i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    }
    DT &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">rbindlist</span>(rowVector)
    <span class="kw">return</span>(DT)
}
<span class="co"># show solution</span>
solution &lt;-<span class="st"> </span><span class="kw">FallingParticleODEApp</span>()
<span class="kw">plot</span>(solution)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-5-1.png" width="672"></p>
</div>
<div id="keplerapp" class="section level2">
<h2 class="hasAnchor">
<a href="#keplerapp" class="anchor"></a>KeplerApp</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#  +++++++++++++++++++++++++++++++++++++++++++++++++++++++++ example KeplerApp.R</span>
<span class="co">#  KeplerApp solves an inverse-square law model (Kepler model) using an adaptive</span>
<span class="co">#  stepsize algorithm.</span>
<span class="co">#  Application showing two planet orbiting</span>
<span class="co">#  File in examples: KeplerApp.R</span>
<span class="kw">library</span>(rODE)
<span class="kw"><a href="reference/importFromExamples.html">importFromExamples</a></span>(<span class="st">"Kepler.R"</span>) <span class="co"># source the class Kepler</span>

KeplerApp &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) {

    <span class="co"># set the orbit into a predefined state.</span>
    r &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">0</span>)                                   <span class="co"># orbit radius</span>
    v &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>)                                <span class="co"># velocity</span>
    dt &lt;-<span class="st"> </span><span class="fl">0.1</span>

    planet &lt;-<span class="st"> </span><span class="kw">Kepler</span>(r, v)
    solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/RK45-class.html">RK45</a></span>(planet)

    rowVector &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>)
    i &lt;-<span class="st"> </span><span class="dv">1</span>
    <span class="cf">while</span> (planet<span class="op">@</span>state[<span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">10</span>) {
        rowVector[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">t  =</span> planet<span class="op">@</span>state[<span class="dv">5</span>],
                               <span class="dt">planet1.r =</span> planet<span class="op">@</span>state[<span class="dv">1</span>],
                               <span class="dt">p1anet1.v =</span> planet<span class="op">@</span>state[<span class="dv">2</span>],
                               <span class="dt">planet2.r =</span> planet<span class="op">@</span>state[<span class="dv">3</span>],
                               <span class="dt">p1anet2.v =</span> planet<span class="op">@</span>state[<span class="dv">4</span>])
        solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/step-method.html">step</a></span>(solver)
        planet &lt;-<span class="st"> </span>solver<span class="op">@</span>ode
        i &lt;-<span class="st">  </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    }
    DT &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">rbindlist</span>(rowVector)
    <span class="kw">return</span>(DT)
}

solution &lt;-<span class="st"> </span><span class="kw">KeplerApp</span>()
<span class="kw">plot</span>(solution)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-6-1.png" width="672"></p>
</div>
<div id="keplerenergyapp" class="section level2">
<h2 class="hasAnchor">
<a href="#keplerenergyapp" class="anchor"></a>KeplerEnergyApp</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ++++++++++++++++++++++++++++++++++++++++++++++++++  example: KeplerEnergyApp.R</span>
<span class="co"># Demostration of the use of the Verlet ODE solver</span>
<span class="co">#</span>
<span class="kw">library</span>(rODE)
<span class="kw"><a href="reference/importFromExamples.html">importFromExamples</a></span>(<span class="st">"KeplerEnergy.R"</span>) <span class="co"># source the class Kepler</span>

KeplerEnergyApp &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) {
    <span class="co"># initial values</span>
    x  &lt;-<span class="st"> </span><span class="dv">1</span>
    vx &lt;-<span class="st"> </span><span class="dv">0</span>
    y  &lt;-<span class="st"> </span><span class="dv">0</span>
    vy &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span>pi
    dt &lt;-<span class="st"> </span><span class="fl">0.01</span>
    tol &lt;-<span class="st"> </span><span class="fl">1e-3</span>
    particle &lt;-<span class="st"> </span><span class="kw">KeplerEnergy</span>()
    particle &lt;-<span class="st"> </span><span class="kw"><a href="reference/init-method.html">init</a></span>(particle, <span class="kw">c</span>(x, vx, y, vy, <span class="dv">0</span>))
    odeSolver &lt;-<span class="st"> </span><span class="kw"><a href="reference/Verlet-class.html">Verlet</a></span>(particle)
    odeSolver &lt;-<span class="st"> </span><span class="kw"><a href="reference/init-method.html">init</a></span>(odeSolver, dt)
    particle<span class="op">@</span>odeSolver &lt;-<span class="st"> </span>odeSolver
    initialEnergy &lt;-<span class="st"> </span><span class="kw"><a href="reference/getEnergy-method.html">getEnergy</a></span>(particle)
    rowVector &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>)
    i &lt;-<span class="st"> </span><span class="dv">1</span>
    <span class="cf">while</span> (<span class="kw"><a href="reference/getTime-method.html">getTime</a></span>(particle) <span class="op">&lt;=</span><span class="st"> </span><span class="fl">1.20</span>) {
        rowVector[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">t  =</span> particle<span class="op">@</span>state[<span class="dv">5</span>],
                               <span class="dt">x  =</span> particle<span class="op">@</span>state[<span class="dv">1</span>],
                               <span class="dt">vx =</span> particle<span class="op">@</span>state[<span class="dv">2</span>],
                               <span class="dt">y  =</span> particle<span class="op">@</span>state[<span class="dv">3</span>],
                               <span class="dt">vy =</span> particle<span class="op">@</span>state[<span class="dv">4</span>],
                               <span class="dt">E  =</span> <span class="kw"><a href="reference/getEnergy-method.html">getEnergy</a></span>(particle))
        particle &lt;-<span class="st"> </span><span class="kw"><a href="reference/doStep-method.html">doStep</a></span>(particle)
        energy &lt;-<span class="st"> </span><span class="kw"><a href="reference/getEnergy-method.html">getEnergy</a></span>(particle)
        i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    }
    DT &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">rbindlist</span>(rowVector)
    <span class="kw">return</span>(DT)
}


solution &lt;-<span class="st"> </span><span class="kw">KeplerEnergyApp</span>()
<span class="kw">plot</span>(solution)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-7-1.png" width="672"></p>
</div>
<div id="logisticapp" class="section level2">
<h2 class="hasAnchor">
<a href="#logisticapp" class="anchor"></a>LogisticApp</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rODE)
<span class="kw"><a href="reference/importFromExamples.html">importFromExamples</a></span>(<span class="st">"Logistic.R"</span>) <span class="co"># source the class Logistic</span>

<span class="co"># Run the application</span>
LogisticApp &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) {
    x  &lt;-<span class="st"> </span><span class="fl">0.1</span>
    vx &lt;-<span class="st"> </span><span class="dv">0</span>
    r  &lt;-<span class="st"> </span><span class="dv">2</span>        <span class="co"># Malthusian parameter (rate of maximum population growth)</span>
    K  &lt;-<span class="st"> </span><span class="fl">10.0</span>     <span class="co"># carrying capacity of the environment</span>
    dt   &lt;-<span class="st"> </span><span class="fl">0.01</span>; tol  &lt;-<span class="st"> </span><span class="fl">1e-3</span>; tmax &lt;-<span class="st"> </span><span class="dv">10</span>
    population &lt;-<span class="st"> </span><span class="kw">Logistic</span>()
    population &lt;-<span class="st"> </span><span class="kw"><a href="reference/init-method.html">init</a></span>(population, <span class="kw">c</span>(x, vx, <span class="dv">0</span>), r, K)
    odeSolver &lt;-<span class="st"> </span><span class="kw"><a href="reference/Verlet-class.html">Verlet</a></span>(population)
    odeSolver &lt;-<span class="st"> </span><span class="kw"><a href="reference/init-method.html">init</a></span>(odeSolver, dt)
    population<span class="op">@</span>odeSolver &lt;-<span class="st"> </span>odeSolver
    rowVector &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>)
    i &lt;-<span class="st"> </span><span class="dv">1</span>
    <span class="cf">while</span> (<span class="kw"><a href="reference/getTime-method.html">getTime</a></span>(population) <span class="op">&lt;=</span><span class="st"> </span>tmax) {
        rowVector[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">t =</span> <span class="kw"><a href="reference/getTime-method.html">getTime</a></span>(population),
                               <span class="dt">s1 =</span> population<span class="op">@</span>state[<span class="dv">1</span>],
                               <span class="dt">s2 =</span> population<span class="op">@</span>state[<span class="dv">2</span>])
        population &lt;-<span class="st"> </span><span class="kw"><a href="reference/doStep-method.html">doStep</a></span>(population)
        i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    }
    DT &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">rbindlist</span>(rowVector)
    <span class="kw">return</span>(DT)
}
<span class="co"># show solution</span>
solution &lt;-<span class="st"> </span><span class="kw">LogisticApp</span>()
<span class="kw">plot</span>(solution)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-8-1.png" width="672"></p>
</div>
<div id="pendulumapp" class="section level2">
<h2 class="hasAnchor">
<a href="#pendulumapp" class="anchor"></a>PendulumApp</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ++++++++++++++++++++++++++++++++++++++++++++++++++      example: PendulumApp.R</span>
<span class="co"># Simulation of a pendulum using the EulerRichardson ODE solver</span>
<span class="kw">library</span>(rODE)
<span class="kw">suppressPackageStartupMessages</span>(<span class="kw">library</span>(ggplot2))
<span class="kw"><a href="reference/importFromExamples.html">importFromExamples</a></span>(<span class="st">"Pendulum.R"</span>)      <span class="co"># source the class</span>

PendulumApp &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) {
    <span class="co"># initial values</span>
    theta &lt;-<span class="st"> </span><span class="fl">0.2</span>
    thetaDot &lt;-<span class="st"> </span><span class="dv">0</span>
    dt &lt;-<span class="st"> </span><span class="fl">0.1</span>
    ode &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">"ODE"</span>)
    pendulum &lt;-<span class="st"> </span><span class="kw">Pendulum</span>()
    pendulum<span class="op">@</span>state[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">0</span>      <span class="co"># set time to zero, t = 0</span>
    pendulum &lt;-<span class="st"> </span><span class="kw"><a href="reference/setState-method.html">setState</a></span>(pendulum, theta, thetaDot)
    pendulum &lt;-<span class="st"> </span><span class="kw"><a href="reference/setStepSize-method.html">setStepSize</a></span>(pendulum, <span class="dt">dt =</span> dt) <span class="co"># using stepSize in RK4</span>
    pendulum<span class="op">@</span>odeSolver &lt;-<span class="st"> </span><span class="kw"><a href="reference/setStepSize-method.html">setStepSize</a></span>(pendulum<span class="op">@</span>odeSolver, dt) <span class="co"># set new step size</span>
    rowvec &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>)
    i &lt;-<span class="st"> </span><span class="dv">1</span>
    <span class="cf">while</span> (pendulum<span class="op">@</span>state[<span class="dv">3</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">40</span>)    {
        rowvec[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">t  =</span> pendulum<span class="op">@</span>state[<span class="dv">3</span>],    <span class="co"># time</span>
                            <span class="dt">theta =</span> pendulum<span class="op">@</span>state[<span class="dv">1</span>], <span class="co"># angle</span>
                            <span class="dt">thetadot =</span> pendulum<span class="op">@</span>state[<span class="dv">2</span>]) <span class="co"># derivative of angle</span>
        pendulum &lt;-<span class="st"> </span><span class="kw"><a href="reference/step-method.html">step</a></span>(pendulum)
        i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    }
    DT &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">rbindlist</span>(rowvec)
    <span class="kw">return</span>(DT)
}
<span class="co"># show solution</span>
solution &lt;-<span class="st"> </span><span class="kw">PendulumApp</span>()
<span class="kw">plot</span>(solution)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-9-1.png" width="672"></p>
</div>
<div id="planetapp" class="section level2">
<h2 class="hasAnchor">
<a href="#planetapp" class="anchor"></a>PlanetApp</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ++++++++++++++++++++++++++++++++++++++++++++++++++++++++  example: PlanetApp.R</span>
<span class="co"># Simulation of Earth orbiting around the SUn using the Euler ODE solver</span>
<span class="kw">library</span>(rODE)
<span class="kw"><a href="reference/importFromExamples.html">importFromExamples</a></span>(<span class="st">"Planet.R"</span>)      <span class="co"># source the class</span>

PlanetApp &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) {
    <span class="co"># x =  1, AU or Astronomical Units. Length of semimajor axis or the orbit</span>
    <span class="co"># of the Earth around the Sun.</span>
    x &lt;-<span class="st"> </span><span class="dv">1</span>; vx &lt;-<span class="st"> </span><span class="dv">0</span>; y &lt;-<span class="st"> </span><span class="dv">0</span>; vy &lt;-<span class="st"> </span><span class="fl">6.28</span>; t &lt;-<span class="st"> </span><span class="dv">0</span>
    state &lt;-<span class="st"> </span><span class="kw">c</span>(x, vx, y, vy, t)
    dt &lt;-<span class="st">  </span><span class="fl">0.01</span>
    planet &lt;-<span class="st"> </span><span class="kw">Planet</span>()
    planet<span class="op">@</span>odeSolver &lt;-<span class="st"> </span><span class="kw"><a href="reference/setStepSize-method.html">setStepSize</a></span>(planet<span class="op">@</span>odeSolver, dt)
    planet &lt;-<span class="st"> </span><span class="kw"><a href="reference/init-method.html">init</a></span>(planet, <span class="dt">initState =</span> state)
    rowvec &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>)
    i &lt;-<span class="st"> </span><span class="dv">1</span>
    <span class="co"># run infinite loop. stop with ESCAPE.</span>
    <span class="cf">while</span> (planet<span class="op">@</span>state[<span class="dv">5</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">90</span>) {     <span class="co"># Earth orbit is 365 days around the sun</span>
        rowvec[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">t  =</span> planet<span class="op">@</span>state[<span class="dv">5</span>],     <span class="co"># just doing 3 months</span>
                            <span class="dt">x  =</span> planet<span class="op">@</span>state[<span class="dv">1</span>],     <span class="co"># to speed up for CRAN</span>
                            <span class="dt">vx =</span> planet<span class="op">@</span>state[<span class="dv">2</span>],
                            <span class="dt">y  =</span> planet<span class="op">@</span>state[<span class="dv">3</span>],
                            <span class="dt">vy =</span> planet<span class="op">@</span>state[<span class="dv">4</span>])
        <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>) {                 <span class="co"># advances time</span>
            planet &lt;-<span class="st"> </span><span class="kw"><a href="reference/doStep-method.html">doStep</a></span>(planet)
        }
        i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    }
    DT &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">rbindlist</span>(rowvec)
    <span class="kw">return</span>(DT)
}

<span class="co"># run the application</span>
solution &lt;-<span class="st"> </span><span class="kw">PlanetApp</span>()
select_rows &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="kw">nrow</span>(solution), <span class="dv">10</span>)      <span class="co"># do not overplot</span>
solution &lt;-<span class="st"> </span>solution[select_rows,]
<span class="kw">plot</span>(solution)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-10-1.png" width="672"></p>
</div>
<div id="projectileapp" class="section level2">
<h2 class="hasAnchor">
<a href="#projectileapp" class="anchor"></a>ProjectileApp</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># +++++++++++++++++++++++++++++++++++++++++++++++++ application: ProjectileApp.R</span>
<span class="co">#                                                      test Projectile with RK4</span>
<span class="co">#                                                      originally uses Euler</span>
<span class="kw">library</span>(rODE)
<span class="kw"><a href="reference/importFromExamples.html">importFromExamples</a></span>(<span class="st">"Projectile.R"</span>)      <span class="co"># source the class</span>

ProjectileApp &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) {
    <span class="co"># initial values</span>
    x &lt;-<span class="st"> </span><span class="dv">0</span>; vx &lt;-<span class="st"> </span><span class="dv">10</span>; y &lt;-<span class="st"> </span><span class="dv">0</span>; vy &lt;-<span class="st"> </span><span class="dv">10</span>
    state &lt;-<span class="st"> </span><span class="kw">c</span>(x, vx, y, vy, <span class="dv">0</span>)                        <span class="co"># state vector</span>
    dt &lt;-<span class="st"> </span><span class="fl">0.01</span>

    projectile &lt;-<span class="st"> </span><span class="kw">Projectile</span>()
    projectile &lt;-<span class="st"> </span><span class="kw"><a href="reference/setState-method.html">setState</a></span>(projectile, x, vx, y, vy)
    projectile<span class="op">@</span>odeSolver &lt;-<span class="st"> </span><span class="kw"><a href="reference/init-method.html">init</a></span>(projectile<span class="op">@</span>odeSolver, <span class="fl">0.123</span>)
    projectile<span class="op">@</span>odeSolver &lt;-<span class="st"> </span><span class="kw"><a href="reference/setStepSize-method.html">setStepSize</a></span>(projectile<span class="op">@</span>odeSolver, dt)
    rowV &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>)
    i &lt;-<span class="st"> </span><span class="dv">1</span>
    <span class="cf">while</span> (projectile<span class="op">@</span>state[<span class="dv">3</span>] <span class="op">&gt;=</span><span class="st"> </span><span class="dv">0</span>)    {
        rowV[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">t =</span> projectile<span class="op">@</span>state[<span class="dv">5</span>],
                          <span class="dt">x  =</span> projectile<span class="op">@</span>state[<span class="dv">1</span>],
                          <span class="dt">vx =</span> projectile<span class="op">@</span>state[<span class="dv">2</span>],
                          <span class="dt">y  =</span> projectile<span class="op">@</span>state[<span class="dv">3</span>],     <span class="co"># vertical position</span>
                          <span class="dt">vy =</span> projectile<span class="op">@</span>state[<span class="dv">4</span>])
        projectile &lt;-<span class="st"> </span><span class="kw"><a href="reference/step-method.html">step</a></span>(projectile)
        i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    }
    DT &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">rbindlist</span>(rowV)
    <span class="kw">return</span>(DT)
}

solution &lt;-<span class="st"> </span><span class="kw">ProjectileApp</span>()
<span class="kw">plot</span>(solution)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-11-1.png" width="672"></p>
</div>
<div id="reactionapp" class="section level2">
<h2 class="hasAnchor">
<a href="#reactionapp" class="anchor"></a>ReactionApp</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># +++++++++++++++++++++++++++++++++++++++++++++++++++ application: ReactionApp.R</span>
<span class="co"># ReactionApp solves an autocatalytic oscillating chemical</span>
<span class="co"># reaction (Brusselator model) using</span>
<span class="co"># a fourth-order Runge-Kutta algorithm.</span>
<span class="kw">library</span>(rODE)
<span class="kw"><a href="reference/importFromExamples.html">importFromExamples</a></span>(<span class="st">"Reaction.R"</span>)      <span class="co"># source the class</span>

ReactionApp &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) {
    X &lt;-<span class="st"> </span><span class="dv">1</span>; Y &lt;-<span class="st"> </span><span class="dv">5</span>;
    dt &lt;-<span class="st"> </span><span class="fl">0.1</span>

    reaction &lt;-<span class="st"> </span><span class="kw">Reaction</span>(<span class="kw">c</span>(X, Y, <span class="dv">0</span>))
    solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/RK4-class.html">RK4</a></span>(reaction)
    rowvec &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>)
    i &lt;-<span class="st"> </span><span class="dv">1</span>
    <span class="cf">while</span> (solver<span class="op">@</span>ode<span class="op">@</span>state[<span class="dv">3</span>] <span class="op">&lt;</span><span class="st"> </span><span class="dv">100</span>) {             <span class="co"># stop at t = 100</span>
        rowvec[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">t =</span> solver<span class="op">@</span>ode<span class="op">@</span>state[<span class="dv">3</span>],
                            <span class="dt">X =</span> solver<span class="op">@</span>ode<span class="op">@</span>state[<span class="dv">1</span>],
                            <span class="dt">Y =</span> solver<span class="op">@</span>ode<span class="op">@</span>state[<span class="dv">2</span>])
        solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/step-method.html">step</a></span>(solver)
        i &lt;-<span class="st">  </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    }
    DT &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">rbindlist</span>(rowvec)
    <span class="kw">return</span>(DT)
}

solution &lt;-<span class="st"> </span><span class="kw">ReactionApp</span>()
<span class="kw">plot</span>(solution)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-12-1.png" width="672"></p>
</div>
<div id="rigidbodynxfapp" class="section level2">
<h2 class="hasAnchor">
<a href="#rigidbodynxfapp" class="anchor"></a>RigidBodyNXFApp</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># +++++++++++++++++++++++++++++++++++++++++++++++ application: RigidBodyNXFApp.R</span>
<span class="co"># example of a nonstiff system is the system of equations describing</span>
<span class="co"># the motion of a rigid body without external forces.</span>
<span class="kw">library</span>(rODE)
<span class="kw"><a href="reference/importFromExamples.html">importFromExamples</a></span>(<span class="st">"RigidBody.R"</span>)

<span class="co"># run the application</span>
RigidBodyNXFApp &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) {
    <span class="co"># load the R class that sets up the solver for this application</span>
    y1 &lt;-<span class="st"> </span><span class="dv">0</span>   <span class="co"># initial y1 value</span>
    y2 &lt;-<span class="st"> </span><span class="dv">1</span>    <span class="co"># initial y2 value</span>
    y3 &lt;-<span class="st"> </span><span class="dv">1</span>    <span class="co"># initial y3 value</span>
    dt        &lt;-<span class="st"> </span><span class="fl">0.01</span> <span class="co"># delta time for step</span>

    body &lt;-<span class="st"> </span><span class="kw">RigidBodyNXF</span>(y1, y2, y3)
    solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/Euler-class.html">Euler</a></span>(body)
    solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/setStepSize-method.html">setStepSize</a></span>(solver, dt)
    rowVector &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>)
    i &lt;-<span class="st"> </span><span class="dv">1</span>
    <span class="co"># stop loop when the body hits the ground</span>
    <span class="cf">while</span> (body<span class="op">@</span>state[<span class="dv">4</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">12</span>) {
        rowVector[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">t  =</span> body<span class="op">@</span>state[<span class="dv">4</span>],
                               <span class="dt">y1 =</span> body<span class="op">@</span>state[<span class="dv">1</span>],
                               <span class="dt">y2 =</span> body<span class="op">@</span>state[<span class="dv">2</span>],
                               <span class="dt">y3 =</span> body<span class="op">@</span>state[<span class="dv">3</span>])
        solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/step-method.html">step</a></span>(solver)
        body &lt;-<span class="st"> </span>solver<span class="op">@</span>ode
        i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    }
    DT &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">rbindlist</span>(rowVector)
    <span class="kw">return</span>(DT)
}

<span class="co"># get the data table from the app</span>
solution &lt;-<span class="st"> </span><span class="kw">RigidBodyNXFApp</span>()
<span class="kw">plot</span>(solution)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-13-1.png" width="672"></p>
</div>
<div id="shoapp" class="section level2">
<h2 class="hasAnchor">
<a href="#shoapp" class="anchor"></a>SHOApp</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rODE)
<span class="kw"><a href="reference/importFromExamples.html">importFromExamples</a></span>(<span class="st">"SHO.R"</span>)

<span class="co"># SHOApp.R</span>
SHOApp &lt;-<span class="st"> </span><span class="cf">function</span>(...) {
    x &lt;-<span class="st"> </span><span class="fl">1.0</span>; v &lt;-<span class="st"> </span><span class="dv">0</span>; k &lt;-<span class="st"> </span><span class="fl">1.0</span>; dt &lt;-<span class="st"> </span><span class="fl">0.01</span>; tolerance &lt;-<span class="st"> </span><span class="fl">1e-3</span>
    sho    &lt;-<span class="st"> </span><span class="kw">SHO</span>(x, v, k)
    solver_factory &lt;-<span class="st"> </span><span class="kw"><a href="reference/ODESolverFactory-class.html">ODESolverFactory</a></span>()
    solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/ODESolverFactory-class.html">createODESolver</a></span>(solver_factory, sho, <span class="st">"DormandPrince45"</span>)
    <span class="co"># solver &lt;- DormandPrince45(sho)                    # this can also be used</span>
    solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/setTolerance-method.html">setTolerance</a></span>(solver, tolerance)
    solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/init-method.html">init</a></span>(solver, dt)
    i &lt;-<span class="st"> </span><span class="dv">1</span>; rowVector &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>)
    <span class="cf">while</span> (sho<span class="op">@</span>state[<span class="dv">3</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">500</span>) {
        rowVector[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">x =</span> sho<span class="op">@</span>state[<span class="dv">1</span>],
                               <span class="dt">v =</span> sho<span class="op">@</span>state[<span class="dv">2</span>],
                               <span class="dt">t =</span> sho<span class="op">@</span>state[<span class="dv">3</span>])
        solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/step-method.html">step</a></span>(solver)
        sho    &lt;-<span class="st"> </span>solver<span class="op">@</span>ode
        i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    }
    <span class="kw">return</span>(data.table<span class="op">::</span><span class="kw">rbindlist</span>(rowVector))
}

solution &lt;-<span class="st"> </span><span class="kw">SHOApp</span>()
<span class="kw">plot</span>(solution)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-14-1.png" width="672"></p>
</div>
<div id="springrk4app" class="section level2">
<h2 class="hasAnchor">
<a href="#springrk4app" class="anchor"></a>SpringRK4App</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ++++++++++++++++++++++++++++++++++++++++++++++++++application:  SpringRK4App.R</span>
<span class="co"># Simulation of a spring considering no friction</span>
<span class="kw">library</span>(rODE)
<span class="kw"><a href="reference/importFromExamples.html">importFromExamples</a></span>(<span class="st">"SpringRK4.R"</span>)

<span class="co"># run application</span>
SpringRK4App &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) {
    theta    &lt;-<span class="st"> </span><span class="dv">0</span>
    thetaDot &lt;-<span class="st"> </span><span class="op">-</span><span class="fl">0.2</span>
    tmax     &lt;-<span class="st"> </span><span class="dv">22</span>; dt &lt;-<span class="st"> </span><span class="fl">0.1</span>
    ode &lt;-<span class="st"> </span><span class="kw">new</span>(<span class="st">"ODE"</span>)
    spring &lt;-<span class="st"> </span><span class="kw">SpringRK4</span>()
    spring<span class="op">@</span>state[<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="dv">0</span>      <span class="co"># set time to zero, t = 0</span>
    spring &lt;-<span class="st"> </span><span class="kw"><a href="reference/setState-method.html">setState</a></span>(spring, theta, thetaDot)
    spring &lt;-<span class="st"> </span><span class="kw"><a href="reference/setStepSize-method.html">setStepSize</a></span>(spring, <span class="dt">dt =</span> dt) <span class="co"># using stepSize in RK4</span>
    spring<span class="op">@</span>odeSolver &lt;-<span class="st"> </span><span class="kw"><a href="reference/setStepSize-method.html">setStepSize</a></span>(spring<span class="op">@</span>odeSolver, dt) <span class="co"># set new step size</span>
    rowvec &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>)
    i &lt;-<span class="st"> </span><span class="dv">1</span>
    <span class="cf">while</span> (spring<span class="op">@</span>state[<span class="dv">3</span>] <span class="op">&lt;=</span><span class="st"> </span>tmax)    {
        rowvec[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">t  =</span> spring<span class="op">@</span>state[<span class="dv">3</span>],      <span class="co"># angle</span>
                            <span class="dt">y1 =</span> spring<span class="op">@</span>state[<span class="dv">1</span>],      <span class="co"># derivative of the angle</span>
                            <span class="dt">y2 =</span> spring<span class="op">@</span>state[<span class="dv">2</span>])      <span class="co"># time</span>
        i &lt;-<span class="st"> </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
        spring &lt;-<span class="st"> </span><span class="kw"><a href="reference/step-method.html">step</a></span>(spring)
    }
    DT &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">rbindlist</span>(rowvec)
    <span class="kw">return</span>(DT)
}

<span class="co"># show solution</span>
solution &lt;-<span class="st"> </span><span class="kw">SpringRK4App</span>()
<span class="kw">plot</span>(solution)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-15-1.png" width="672"></p>
</div>
<div id="vanderpolapp" class="section level2">
<h2 class="hasAnchor">
<a href="#vanderpolapp" class="anchor"></a>VanderpolApp</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ++++++++++++++++++++++++++++++++++++++++++++++++   application: VanderPolApp.R</span>
<span class="co"># Solution of the Van der Pol equation</span>
<span class="co">#</span>
<span class="kw">library</span>(rODE)
<span class="kw"><a href="reference/importFromExamples.html">importFromExamples</a></span>(<span class="st">"VanderPol.R"</span>)

<span class="co"># run the application</span>
VanderpolApp &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) {
    <span class="co"># set the orbit into a predefined state.</span>
    y1 &lt;-<span class="st"> </span><span class="dv">2</span>; y2 &lt;-<span class="st"> </span><span class="dv">0</span>; dt &lt;-<span class="st"> </span><span class="fl">0.1</span>;
    rigid_body &lt;-<span class="st"> </span><span class="kw">VanderPol</span>(y1, y2)
    solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/RK45-class.html">RK45</a></span>(rigid_body)
    rowVector &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>)
    i &lt;-<span class="st"> </span><span class="dv">1</span>
    <span class="cf">while</span> (rigid_body<span class="op">@</span>state[<span class="dv">3</span>] <span class="op">&lt;=</span><span class="st"> </span><span class="dv">20</span>) {
        rowVector[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">t =</span>  rigid_body<span class="op">@</span>state[<span class="dv">3</span>],
                               <span class="dt">y1 =</span> rigid_body<span class="op">@</span>state[<span class="dv">1</span>],
                               <span class="dt">y2 =</span> rigid_body<span class="op">@</span>state[<span class="dv">2</span>])
        solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/step-method.html">step</a></span>(solver)
        rigid_body &lt;-<span class="st"> </span>solver<span class="op">@</span>ode
        i &lt;-<span class="st">  </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    }
    DT &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">rbindlist</span>(rowVector)
    <span class="kw">return</span>(DT)
}

<span class="co"># show solution</span>
solution &lt;-<span class="st"> </span><span class="kw">VanderpolApp</span>()
<span class="kw">plot</span>(solution)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-16-1.png" width="672"></p>
</div>
<div id="vanderpolmutimecontrolapp" class="section level2">
<h2 class="hasAnchor">
<a href="#vanderpolmutimecontrolapp" class="anchor"></a>VanderpolMuTimeControlApp</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># +++++++++++++++++++++++++++++++++++++     example: VanderpolMuTimeControlApp.R</span>
<span class="co"># This is a modification of the original Vanderpol.R script</span>
<span class="co"># In this version, we will add tha ability of setting mu and time lapse.</span>
<span class="co"># This example is also shown in the Matlab help guide</span>
<span class="kw">library</span>(rODE)
<span class="kw"><a href="reference/importFromExamples.html">importFromExamples</a></span>(<span class="st">"VanderpolMuTimeControl.R"</span>)

<span class="co"># run the application</span>
VanderpolMuTimeControlApp &lt;-<span class="st"> </span><span class="cf">function</span>(<span class="dt">verbose =</span> <span class="ot">FALSE</span>) {
    <span class="co"># set the orbit into a predefined state.</span>
    y1 &lt;-<span class="st"> </span><span class="dv">2</span>; y2 &lt;-<span class="st"> </span><span class="dv">0</span>; mu &lt;-<span class="st"> </span><span class="dv">10</span>; tmax &lt;-<span class="st"> </span>mu <span class="op">*</span><span class="st"> </span><span class="dv">3</span>; dt &lt;-<span class="st"> </span><span class="fl">0.01</span>
    rigid_body &lt;-<span class="st"> </span><span class="kw">VanderPol</span>(y1, y2, mu)
    solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/RK45-class.html">RK45</a></span>(rigid_body)
    rowVector &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">"list"</span>)
    i &lt;-<span class="st"> </span><span class="dv">1</span>
    <span class="cf">while</span> (rigid_body<span class="op">@</span>state[<span class="dv">3</span>] <span class="op">&lt;=</span><span class="st"> </span>tmax) {
        rowVector[[i]] &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">t =</span>  rigid_body<span class="op">@</span>state[<span class="dv">3</span>],
                               <span class="dt">y1 =</span> rigid_body<span class="op">@</span>state[<span class="dv">1</span>],
                               <span class="dt">y2 =</span> rigid_body<span class="op">@</span>state[<span class="dv">2</span>]
                               )
        solver &lt;-<span class="st"> </span><span class="kw"><a href="reference/step-method.html">step</a></span>(solver)
        rigid_body &lt;-<span class="st"> </span>solver<span class="op">@</span>ode
        i &lt;-<span class="st">  </span>i <span class="op">+</span><span class="st"> </span><span class="dv">1</span>
    }
    DT &lt;-<span class="st"> </span>data.table<span class="op">::</span><span class="kw">rbindlist</span>(rowVector)
    <span class="kw">return</span>(DT)
}

<span class="co"># show solution</span>
solution &lt;-<span class="st"> </span><span class="kw">VanderpolMuTimeControlApp</span>()
<span class="kw">plot</span>(solution)</code></pre></div>
<p><img src="reference/figures/README-unnamed-chunk-17-1.png" width="672"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cran.r-project.org/package=rODE">https://â€‹cran.r-project.org/â€‹package=rODE</a>
</li>
<li>Browse source code at <br><a href="https://github.com/f0nzie/rODE">https://â€‹github.com/â€‹f0nzie/â€‹rODE</a>
</li>
</ul>
<h2>License</h2>
<p><a href="https://www.r-project.org/Licenses/GPL-2">GPL-2</a></p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Alfonso R. Reyes <br><small class="roles"> Author, maintainer </small> </li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://cran.r-project.org/package=rODE"><img src="http://www.r-pkg.org/badges/version/rODE" alt="CRAN_Status_Badge"></a></li>
<li><a href="https://travis-ci.org/f0nzie/rODE"><img src="https://travis-ci.org/f0nzie/rODE.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://codecov.io/gh/f0nzie/rODE"><img src="https://codecov.io/gh/f0nzie/rODE/branch/master/graph/badge.svg" alt="Coverage Status"></a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Alfonso R. Reyes.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
